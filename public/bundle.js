!function(e){var t={};function n(l){if(t[l])return t[l].exports;var i=t[l]={i:l,l:!1,exports:{}};return e[l].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(l,i,function(t){return e[t]}.bind(null,i));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const l=[],i=(e,t,n,l,i)=>({x:e,y:t,xPos:0,yPos:0,color:n,name:l,n:i}),o=["spades","clubs","hearts","diamonds"];for(let e=99.5;e<=398;e+=99.5)for(let t=0;t<858;t+=66){let n=e<200?"black":"red";const s=o[e/99.5-1],h=t/66;l.push(i(t,e,n,s,h))}var s=l;const h=document.getElementById("canvas"),c=h.getContext("2d"),r=new Image;r.src="/public/images/cards.png";const g=document.getElementById("fullscreen");console.log(s),h.height=600,h.width=600;const d={pile:[]},p={width:65,height:97,spaceBetween:10,spaceOfHidden:2},u=[],a={click:!1,mousemove:!1,mouseup:!0},f=(e,t,n)=>u.push({x:e,y:t,type:n,pile:[]});const m=[];let y=0;var w,v,x,b,k,O;w=97,v=145,x=40,b=4,k=screen.width,O=screen.height,h.height=O,h.width=k,p.width=w,p.height=v,p.spaceBetween=x,p.spaceOfHidden=b,function(){u.length=0;let e=(h.width-7*p.width)/8;for(let t=e;t<h.width;t+=p.width+e)f(t,30,u.length<3?0:1),f(t,60+p.height,2);u.splice(4,1),function(){for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*e),n=s[t];s[t]=s[e],s[e]=n}}(),u.forEach(e=>{e.pile.length=0});let t=0;for(let e=0;e<7;e++){const n=2*e+(e>1?0:1);for(let l=0;l<=e;l++)u[n].pile.push(s[t++])}u[2].pile.push(...s.slice(t,s.length))}();const P=e=>{let t,n=!0;for(let e=0;e<u.length;e++)1!==u[e].type&&u[e].pile.length&&(n=!1);if(c.fillStyle="red",c.fillRect(0,0,h.width,h.height),c.drawImage(r,66,0,65,97,u[0].x,u[0].y,p.width,p.height),a.click){const e=h.getBoundingClientRect(),t=u[0],n=a.mouse.clientX-e.x,l=a.mouse.clientY-e.y;n>=t.x&&n<=t.x+p.width&&l>=t.y&&l<=t.y+p.height&&u[2].pile.length&&(a.click=!1,u[2].pile.unshift(u[2].pile.pop()),m.push("deck"),m.splice(m.length-y,y),y=0)}for(let e=0;e<u.length;e++){const n=u[e].pile;let l=u[e].x,i=u[e].y;u[e].type;let o,s;n.length&&!n[n.length-1]&&console.log("current pile at length minus one is undefined:",n),n.length&&!n[n.length-1].side&&a.mouseup&&(n[n.length-1].side=1),0===u[e].type&&u[e].pile.forEach(e=>e.side=1),2!==e&&e>0&&!n.length&&(c.beginPath(),c.rect(l,i,p.width,p.height),c.stroke(),c.closePath());for(let t=0;t<u[e].pile.length;t++){const g=n[t],f=g.side?g.x:66,w=g.side?g.y:0;if(c.drawImage(r,f,w,65,97,l,i,p.width,p.height),g.side||(c.beginPath(),c.rect(l,i,p.width-3,p.height),c.stroke(),c.closePath()),a.click&&!d.pile.length){const e=h.getBoundingClientRect(),n=a.mouse.clientX-e.x,c=a.mouse.clientY-e.y;n>=l&&n<=l+p.width&&c>=i&&c<=i+p.height&&g.side&&(o=t,m.splice(m.length-y,y),y=0,s={x:l-n,y:i-c})}2===u[e].type&&(i+=g.side?p.spaceBetween:p.spaceOfHidden)}if(d.pile.length){const o=h.getBoundingClientRect(),s=a.mouse.clientX-o.x,c=a.mouse.clientY-o.y,r=d.pile[0];s>=l&&s<=l+p.width&&c>=i&&c<=i+p.height&&(2===u[e].type&&(n.length||12!==r.n||(t=e),n.length&&r.n===n[n.length-1].n-1&&r.color!==n[n.length-1].color&&(t=e)),1===u[e].type&&(n.length||0!==r.n||(t=e),n.length&&r.n&&r.n===n[n.length-1].n+1&&r.name===n[n.length-1].name&&(t=e)))}void 0!==o&&(d.origin=e,d.pile=n.splice(o,n.length-o),d.side=!!n.length&&n[n.length-1].side,d.selectedPoint=s,a.click=!1),e===u.length-1&&(a.click=!1)}if(d.target=void 0!==t?t:null,d.pile.length){const e=h.getBoundingClientRect();let t=a.mouse.clientX+d.selectedPoint.x-e.x,n=a.mouse.clientY+d.selectedPoint.y-e.y;for(let e=0;e<d.pile.length;e++)c.drawImage(r,d.pile[e].x,d.pile[e].y,65,97,t,n,p.width,p.height),n+=p.spaceBetween}if(n)return c.fillStyle="rgb(0, 0, 0, 0.7)",c.fillRect(0,0,h.width,h.height),c.fillStyle="white",c.font="100px Arial Black",c.textAlign="center",void c.fillText("YOU WON!",h.width/2,h.height/2);window.requestAnimationFrame(P)};h.addEventListener("mousedown",e=>{a.mouseup&&(a.click=!0,a.mouseup=!1,a.mouse=e)}),h.addEventListener("mousemove",e=>{a.mouseup||(a.mouse=e)}),h.addEventListener("mouseup",e=>{a.mouseup=!0,d.pile.length&&(null===d.target?u[d.origin].pile.push(...d.pile):(m.push(JSON.parse(JSON.stringify(d))),u[d.target].pile.push(...d.pile)),d.pile.length=0,d.origin=null,d.target=null)}),h.addEventListener("dblclick",e=>{for(let e=0;e<u.length;e++){if(1===u[e].type||!u[e].pile.length)continue;const t=u[e].pile,n=t[t.length-1];for(let l=0;l<u.length;l++){if(1!==u[l].type)continue;const i=u[l].pile;if(!i.length&&0===n.n||i.length&&n.n===i[i.length-1].n+1&&n.name===i[i.length-1].name){d.pile=[t.pop()],d.target=l,d.origin=e,d.side=!!t.length&&t[t.length-1].side,m.splice(m.length-y,y),m.push(JSON.parse(JSON.stringify(d))),y=0,u[d.target].pile.push(...d.pile),d.origin=null,d.target=null,d.pile.length=0;break}}}}),document.getElementById("undo").addEventListener("click",()=>{const e=m[m.length-y-1];if(e){if(console.log("last move:",e),"deck"===e)u[2].pile.push(u[2].pile.shift());else{const t=u[e.origin].pile,n=u[e.target].pile,l=e.pile.length;(!1!==e.side||void 0!==e.side&&t.length)&&(t[t.length-1].side=e.side),t.push(...n.splice(n.length-l,l))}y++}}),g.addEventListener("click",()=>h.requestFullscreen()),P()}]);
//# sourceMappingURL=bundle.js.map